<script>
    function getCookie(name = '') {
        let cookies = document.cookie;
        let cookiestore = {};

        cookies = cookies.split(";");

        if (cookies[0] == "" && cookies[0][0] == undefined) {
            return undefined;
        }

        cookies.forEach(function (cookie) {
            cookie = cookie.split(/=(.+)/);
            if (cookie[0].substr(0, 1) == ' ') {
                cookie[0] = cookie[0].substr(1);
            }
            cookiestore[cookie[0]] = cookie[1];
        });

        return (name !== '' ? cookiestore[name] : cookiestore);
    }
    var x = getCookie('email');
    var y = x.replace('email=', '');
    var displayEmail = y.replace('%40', '@');
</script>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="generic-style.css">
    <title>Thank you for your purchase!</title>
</head>

<body>
    <header>
        <h3>Order Confirmation</h3>
        <ul>
            <span id="name_display" class="name_display">
                <script>
                    // script to show username
                    if (getCookie('login') != undefined) {
                        document.getElementById('name_display').innerHTML = `Welcome ${display}`;
                    } else {
                        document.getElementById('name_display').innerHTML = "Hello, please sign in or register!";
                    };
                </script>
            </span>
            <span id="login_register_logout" class="login_register_logout">
                <script>
                    // script to check for login cookie and give either login/register buttons or give a logout button
                    if (getCookie('login') != undefined) {
                        document.getElementById('login_register_logout').innerHTML = `<form name="logout" action="/logout" method="GET"><input type="submit" value="Log Out"></form>`;
                    } else {
                        document.getElementById('login_register_logout').innerHTML = `<form name="login" action="/login" method="GET"><input type="submit" value="Log In"></form>
                                                                                    <form name="register" action="/register" method="GET"><input type="submit" value="Register"></form>`;
                    };
                </script>
            </span>
            <span id="cart_quantity" class="cart_quantity">
                <script>
                    // script to dynamically generate cart quantity
                    if (sessionStorage.length > 0) {
                        var cartQuantity = 0;
                        for (i = 0; i < products_array.length; i++) {
                            var x = JSON.parse(sessionStorage.getItem(`cartProduct${i}`));
                            if (x != null) {
                                var quantityToAdd = Number(x['quantity']);
                                cartQuantity += quantityToAdd;
                            } else {
                                var quantityToAdd = 0;
                                cartQuantity += quantityToAdd;
                            }
                        } if (cartQuantity === 1) {
                            document.getElementById('cart_quantity').innerHTML = 'There is 1 item in your cart.';
                        } else {
                            document.getElementById('cart_quantity').innerHTML = `There are ${cartQuantity} items in your cart.`;
                        }
                    } else {
                        document.getElementById('cart_quantity').innerHTML = "There are 0 items in your cart";
                    }
                </script>
                <form id="myCart" class="myCart" action="/cart" method="GET"><input type="submit" value="My Cart">
                </form>
                <input type="submit" id="clearcart" value="Clear Cart" onclick="ClearCart();">
            </span>
        </ul>
        <div class="homebutton">
            <input type=button onclick="window.location.href='/'" value="Back to Shop">
        </div>
    </header>
    <script>
        document.write(`Thank you for your purchase!  We will be sending an e-mail to ${displayEmail}.`);
    </script>
</body>

</html>